---
layout: post
title: Week-3
date: 2019-06-13
---

*Blog update.. in progres..*
**DOCKER FILES**

* ROS1

(done.. post image here)

* ROS2

(done ...post image here)

* ROS1+ROS2

(using multiple FROM 

The multi-stage Dockerfile

This was not working correctly. Only the distro which had installation lines in last is working.

Next approach:

Use correctly with docker-compose

Link to Docker file: [docker-file](https://github.com/TheRoboticsClub/colab-gsoc2019-Pankhuri_Vanjani/tree/master/Dockerfiles)



To Build: ```sudo docker-compose build```

```
pankhuri@pankhuri-LENOVO-IDEAPAD-500-15ISK:~/Docker/compose-ros/compose$ sudo docker-compose build
Building ros-melodic
Step 1/12 : FROM ubuntu:bionic
 ---> 7698f282e524
Step 2/12 : RUN apt update
 ---> Using cache
 ---> 568646da8ec6
Step 3/12 : RUN apt-get install -y lsb-release
 ---> Using cache
 ---> e596418dd9b3
Step 4/12 : RUN apt-get update && apt-get install -y gnupg2
 ---> Using cache
 ---> c286b7ad7497
Step 5/12 : RUN sh -c 'echo "deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main" > /etc/apt/sources.list.d/ros-latest.list'
 ---> Using cache
 ---> 78d04a1323e3
Step 6/12 : RUN apt-key adv --keyserver 'hkp://keyserver.ubuntu.com:80' --recv-key C1CF6E31E6BADE8868B172B4F42ED6FBAB17C654
 ---> Using cache
 ---> f299aab835d2
Step 7/12 : RUN apt update
 ---> Using cache
 ---> 17d94468b7a1
Step 8/12 : RUN apt-get install -y tzdata
 ---> Using cache
 ---> 0edf53f0acb2
Step 9/12 : RUN apt install -y ros-melodic-desktop-full
 ---> Using cache
 ---> 7cd5b422f162
Step 10/12 : RUN apt install -y python-rosinstall python-rosinstall-generator python-wstool build-essential
 ---> Using cache
 ---> 317774ee917a
Step 11/12 : RUN rosdep init
 ---> Using cache
 ---> 0817ce31cb84
Step 12/12 : RUN rosdep update
 ---> Using cache
 ---> 1cab27d973e2

Successfully built 1cab27d973e2
Successfully tagged compose_ros-melodic:latest
Building ros-dashing
Step 1/12 : FROM ubuntu:bionic
 ---> 7698f282e524
Step 2/12 : RUN apt update
 ---> Using cache
 ---> 568646da8ec6
Step 3/12 : RUN apt update
 ---> Using cache
 ---> 00045212a5ec
Step 4/12 : RUN apt-get -y install lsb-release
 ---> Using cache
 ---> ebe7739f5832
Step 5/12 : RUN apt install -y curl gnupg2 lsb-release
 ---> Using cache
 ---> 08e7835374cb
Step 6/12 : RUN curl http://repo.ros2.org/repos.key | apt-key add -
 ---> Using cache
 ---> 39571bff8738
Step 7/12 : RUN sh -c 'echo "deb [arch=amd64,arm64] http://packages.ros.org/ros2/ubuntu `lsb_release -cs` main" > /etc/apt/sources.list.d/ros2-latest.list'
 ---> Using cache
 ---> 008a3501d19f
Step 8/12 : RUN apt update
 ---> Using cache
 ---> e2507e06a78f
Step 9/12 : RUN apt-get install -y tzdata
 ---> Using cache
 ---> 2e5d879aa103
Step 10/12 : RUN apt install -y ros-dashing-desktop
 ---> Using cache
 ---> 15899903dddf
Step 11/12 : RUN apt install -y python3-argcomplete
 ---> Using cache
 ---> b660771fbba1
Step 12/12 : RUN apt update
 ---> Using cache
 ---> 0b9120516da4

Successfully built 0b9120516da4
Successfully tagged compose_ros-dashing:latest

```
Next command ```sudo docker-compose up ```

```
pankhuri@pankhuri-LENOVO-IDEAPAD-500-15ISK:~/Docker/compose-ros/compose$ sudo docker-compose up
Starting compose_ros-melodic_1 ... done
Starting compose_ros-dashing_1 ... done
Attaching to compose_ros-melodic_1, compose_ros-dashing_1
compose_ros-dashing_1 exited with code 0
compose_ros-melodic_1 exited with code 0

```
So, 


```
pankhuri@pankhuri-LENOVO-IDEAPAD-500-15ISK:~/Docker/compose-ros/compose$ sudo docker-compose ps
        Name             Command    State    Ports
--------------------------------------------------
compose_ros-dashing_1   /bin/bash   Exit 0        
compose_ros-melodic_1   /bin/bash   Exit 0  
```
For executing: ``` sudo docker exec -it compose_ros-melodic_1 /bin/bash ````

```
pankhuri@pankhuri-LENOVO-IDEAPAD-500-15ISK:~/Docker/compose-ros/compose$ sudo docker exec -it compose_ros-melodic_1 /bin/bash
Error response from daemon: Container 3bda7fdfa704745fe9cdf738c06adae18410d83f7cf40a44330fb7a67fe6608f is not running
```
Next: Since, I am not able to get ahead now, discuss with mentors this issue and correct it then. 

*Read and discuss about Entrypoints to enter into container*

Links which were referred: [Docker Compose](https://www.linux.org/threads/docker-compose.23562/?fbclid=IwAR2k5OB6GzXVAHoxhuTZrde8Bqh5W8kDDMs7DMoZ-uknVxd66NKDvXO8RcY)


**Wrapper for image display**

*from 'hello world' to image publisher subscriber*

Interface working well with ROS1 Image driver

(add image)

With ROS2:

Image is getting published..i.e. publisher working fine but Listener is not going ahead. (same driver created earlier)

It was working and created in Crystal, so worked well in it.

Giving some errors in dashing.

UPdate: Solved it now.

UPDATE: (16th June)

Wrapper - created for ROS2 Publisher

for ROS1- in progress

Earlier I was just reading and displaying an image from a given path in ROS1 whichi was fine, but now displaying from webcam. Image viewing screen is showing green background.  

**Target now:**

Include as wrapper instead for subscriber too inside interface :: Done now

  (Click on the image to watch video)
 
 [![ROS1-ROS2-Camera](http://img.youtube.com/vi/0QGvgdslvIU/0.jpg)](http://www.youtube.com/watch?v=0QGvgdslvIU "Image-display")
 


Another Idea: Use of ROS1-BRIDGE; We can publish image from ROS1 and read in ROS2 and ROS1 both and vice versa

Create Docker file for both ROS1 and ROS2.
Faced many errors as I was trying to include two base images. Now maybe I will download both ROS1 and ROS2 in my environment and create a docker from there

